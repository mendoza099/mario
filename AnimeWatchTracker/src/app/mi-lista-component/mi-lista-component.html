<div class="mi-lista-container">
  <h1>Mi Lista de Animes</h1>

  <div class="stats-grid">
    <div class="stat-card" [class.active]="filtroActivo() === 'Todos'" (click)="cambiarFiltro('Todos')">
      <div class="stat-number">{{ estadisticas().total }}</div>
      <div class="stat-label">Total</div>
    </div>
    
    <div class="stat-card" [class.active]="filtroActivo() === 'Favoritos'" (click)="cambiarFiltro('Favoritos')">
      <div class="stat-number">{{ estadisticas().favoritos }}</div>
      <div class="stat-label">‚ù§Ô∏è Favoritos</div>
    </div>
    
    <div class="stat-card" [class.active]="filtroActivo() === 'Pendiente'" (click)="cambiarFiltro('Pendiente')">
      <div class="stat-number">{{ estadisticas().pendiente }}</div>
      <div class="stat-label">Pendiente</div>
    </div>
    
    <div class="stat-card" [class.active]="filtroActivo() === 'Viendo'" (click)="cambiarFiltro('Viendo')">
      <div class="stat-number">{{ estadisticas().viendo }}</div>
      <div class="stat-label">Viendo</div>
    </div>
    
    <div class="stat-card" [class.active]="filtroActivo() === 'Completado'" (click)="cambiarFiltro('Completado')">
      <div class="stat-number">{{ estadisticas().completado }}</div>
      <div class="stat-label">Completado</div>
    </div>
    
    <div class="stat-card" [class.active]="filtroActivo() === 'Abandonado'" (click)="cambiarFiltro('Abandonado')">
      <div class="stat-number">{{ estadisticas().abandonado }}</div>
      <div class="stat-label">Abandonado</div>
    </div>
  </div>

  @if (listaFiltrada().length === 0) {
    <div class="empty-state">
      <h2>Tu lista est√° vac√≠a</h2>
      <p>Comienza a explorar y a√±ade animes a tu lista personal</p>
      <a routerLink="/" class="btn-explore">Explorar Animes</a>
    </div>
  } @else {
    <div class="filter-info">
      <h2>{{ filtroActivo() }} ({{ listaFiltrada().length }})</h2>
    </div>

    <div class="anime-grid">
      @for (anime of listaFiltrada(); track anime.anime.mal_id) {
        <div class="anime-card">
          <a [routerLink]="['/anime', anime.anime.mal_id]" class="anime-link">
            <img 
              [src]="anime.anime.images.jpg.large_image_url" 
              [alt]="anime.anime.title"
              class="anime-image"
            />
            <div class="anime-overlay">
              <span class="status-badge" [attr.data-status]="anime.estado">
                {{ anime.estado }}
              </span>
            </div>
          </a>
          
          <div class="anime-info">
            <h3>{{ anime.anime.title }}</h3>
            
            <div class="anime-meta">
              <span class="score">‚≠ê {{ anime.anime.score || 'N/A' }}</span>
            </div>

            <div class="anime-actions">
              <button 
                (click)="cambiarFavorito(anime.anime.mal_id)"
                [class.favorite]="anime.esFavorito"
                class="btn-favorite-small"
                title="Marcar como favorito"
              >
                {{ anime.esFavorito ? '‚ù§Ô∏è' : 'ü§ç' }}
              </button>
              
              <button 
                (click)="eliminarAnime(anime.anime.mal_id)"
                class="btn-remove"
                title="Eliminar de lista"
              >
                üóëÔ∏è
              </button>
            </div>
          </div>
        </div>
      }
    </div>
  }
</div>
